(window.webpackJsonp=window.webpackJsonp||[]).push([[0],{19:function(e,t,n){"use strict";(function(e){n.d(t,"d",function(){return d}),n.d(t,"g",function(){return f}),n.d(t,"a",function(){return b}),n.d(t,"b",function(){return h}),n.d(t,"c",function(){return v}),n.d(t,"e",function(){return p}),n.d(t,"f",function(){return _});var r=n(4),a=n(9),i=n(0),o=n.n(i),c=n(80),s=n(29),u=n(25),l=function(e){return null===e?"No":((new Date).getTime()-Date.parse(e))/864e5<=7?"Yes":"No"},d=function(e,t,n){return o.a.map(e,function(e){var r=Object.keys(e),i=o.a.map(r,function(t){return e[t]}),c=i[a.b.visited_in_last_week]?l(i[a.b.last_visit]):"No";return n(t+1),{Number:i[a.b.Number]?i[a.b.Number]:-1,surname:i[a.b.surname]?i[a.b.surname]:[],name:i[a.b.name]?i[a.b.name]:[],second_member:i[a.b.second_member]?i[a.b.second_member]:[],last_visit:i[a.b.last_visit],visited_in_last_week:c,number_of_kids:i[a.b.number_of_kids]?i[a.b.number_of_kids]:"--",address_street:i[a.b.address]?i[a.b.address]:"--",crossing_city:i[a.b.city]?i[a.b.city]:"--",border_crossing:i[a.b.border_crossing]?i[a.b.border_crossing]:"--",comments:i[a.b.comments]?i[a.b.comments]:"--",deny:i[a.b.deny]?i[a.b.deny]:"--",year_of_birth:i[a.b.year_of_birth]?i[a.b.year_of_birth]:"--",isDisabled:"Yes"===c,isActive:"Deny"===i[a.b.deny]||"DENY"===i[a.b.deny]||"deny"===i[a.b.deny]}})},m=function(e){return{Number:e.Number?e.Number:"--",Surname:e.surname?e.surname:"--",Name:e.name?e.name:"--","Second Member":e.second_member?e.second_member:"--","Number of Kids":e.number_of_kids?e.number_of_kids:"--",Address:e.address?e.address:"--",City:e.city?e.city:"--","Border Crossing":e.border_crossing?e.border_crossing:"--","Year of Birth":e.year_of_birth?e.year_of_birth:"--","Last Visit":e.last_visit?e.last_visit:"--","Visited in Last Week":e.visited_in_last_week?e.visited_in_last_week:"--",Comments:e.comments?e.comments:"--",Deny:e.deny?e.deny:"--","Previous Visits":e.previous_visits?e.previous_visits:"--"}},f=function(e,t,n,a,i,c){if(null===t){var s=m(e);Object(u.c)(s).then(),a(o.a.flatten(o.a.concat(n,e)))}else{var d=Object(r.a)({},t,e),f=o.a.map(n,function(e){if(e.Number===t.Number){var n=Object(r.a)({},e,d),a=Object(r.a)({},n,{visited_in_last_week:l(n.last_visit),isDisabled:"Yes"===n.visited_in_last_week,isActive:"Deny"===n.deny||"deny"===n.deny||"DENY"===n.deny}),i=m(a);return Object(u.b)(i).then(),a}return e});a(f),c(_(f))}i({})},b=function(e,t,n,a,i,s,l,d,f){var b=o.a.map(o.a.isEmpty(l)?t:l,function(t){if(t.Number==e){var a=Object(r.a)({},t,{last_visit:Object(c.a)(new Date,"yyyy-MM-dd"),visited_in_last_week:"Yes",isSelected:!1,isDisabled:!0,previous_visits:o.a.isEmpty(t.last_visit)?t.previous_visits:[t.previous_visits,t.last_visit]});return f(n+1),Object(u.b)(m(a)).then(),a}return t});o.a.isEmpty(l)?a(b):d(b),i(!0),s(!1)},h=function(e,t,n,a,i,c,s,l,d){var f=o.a.map(o.a.isEmpty(s)?t:s,function(t){if(t.Number==e){var a=Object(r.a)({},t,{last_visit:"--",visited_in_last_week:"No",isSelected:!1,isDisabled:!0,previous_visits:o.a.isEmpty(t.last_visit)?t.previous_visits:[t.previous_visits,t.last_visit]});return d(n+1),Object(u.b)(m(a)).then(),a}return t});o.a.isEmpty(s)?a(f):l(f),i(!1),c(!0)},v=function(t){var r=Object(s.json_to_sheet)(t),a=Object(s.book_new)(),i=n(72).join(e,"Data/example_data.xlsx");Object(s.book_append_sheet)(a,r,"Example_Data"),Object(s.writeFile)(a,i)},p=function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:function(e){},r=o.a.map(t,function(t){var n=t.Number+t.surname+t.second_member;if(o.a.includes(o.a.toLower(n),o.a.toLower(e)))return t});return n(0),o.a.without(r,void 0)},_=function(e){var t=0;return o.a.forEach(e,function(e){"Yes"===e.visited_in_last_week&&(t+=1)}),t}}).call(this,"/")},25:function(e,t,n){"use strict";n.d(t,"a",function(){return o}),n.d(t,"b",function(){return c}),n.d(t,"c",function(){return s});var r=n(37),a=n(39);function i(){i=function(){return e};var e={},t=Object.prototype,n=t.hasOwnProperty,r=Object.defineProperty||function(e,t,n){e[t]=n.value},a="function"==typeof Symbol?Symbol:{},o=a.iterator||"@@iterator",c=a.asyncIterator||"@@asyncIterator",s=a.toStringTag||"@@toStringTag";function u(e,t,n){return Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}),e[t]}try{u({},"")}catch(C){u=function(e,t,n){return e[t]=n}}function l(e,t,n,a){var i=t&&t.prototype instanceof f?t:f,o=Object.create(i.prototype),c=new N(a||[]);return r(o,"_invoke",{value:w(e,n,c)}),o}function d(e,t,n){try{return{type:"normal",arg:e.call(t,n)}}catch(C){return{type:"throw",arg:C}}}e.wrap=l;var m={};function f(){}function b(){}function h(){}var v={};u(v,o,function(){return this});var p=Object.getPrototypeOf,_=p&&p(p(S([])));_&&_!==t&&n.call(_,o)&&(v=_);var y=h.prototype=f.prototype=Object.create(v);function g(e){["next","throw","return"].forEach(function(t){u(e,t,function(e){return this._invoke(t,e)})})}function E(e,t){var a;r(this,"_invoke",{value:function(r,i){function o(){return new t(function(a,o){!function r(a,i,o,c){var s=d(e[a],e,i);if("throw"!==s.type){var u=s.arg,l=u.value;return l&&"object"==typeof l&&n.call(l,"__await")?t.resolve(l.__await).then(function(e){r("next",e,o,c)},function(e){r("throw",e,o,c)}):t.resolve(l).then(function(e){u.value=e,o(u)},function(e){return r("throw",e,o,c)})}c(s.arg)}(r,i,a,o)})}return a=a?a.then(o,o):o()}})}function w(e,t,n){var r="suspendedStart";return function(a,i){if("executing"===r)throw new Error("Generator is already running");if("completed"===r){if("throw"===a)throw i;return x()}for(n.method=a,n.arg=i;;){var o=n.delegate;if(o){var c=O(o,n);if(c){if(c===m)continue;return c}}if("next"===n.method)n.sent=n._sent=n.arg;else if("throw"===n.method){if("suspendedStart"===r)throw r="completed",n.arg;n.dispatchException(n.arg)}else"return"===n.method&&n.abrupt("return",n.arg);r="executing";var s=d(e,t,n);if("normal"===s.type){if(r=n.done?"completed":"suspendedYield",s.arg===m)continue;return{value:s.arg,done:n.done}}"throw"===s.type&&(r="completed",n.method="throw",n.arg=s.arg)}}}function O(e,t){var n=t.method,r=e.iterator[n];if(void 0===r)return t.delegate=null,"throw"===n&&e.iterator.return&&(t.method="return",t.arg=void 0,O(e,t),"throw"===t.method)||"return"!==n&&(t.method="throw",t.arg=new TypeError("The iterator does not provide a '"+n+"' method")),m;var a=d(r,e.iterator,t.arg);if("throw"===a.type)return t.method="throw",t.arg=a.arg,t.delegate=null,m;var i=a.arg;return i?i.done?(t[e.resultName]=i.value,t.next=e.nextLoc,"return"!==t.method&&(t.method="next",t.arg=void 0),t.delegate=null,m):i:(t.method="throw",t.arg=new TypeError("iterator result is not an object"),t.delegate=null,m)}function j(e){var t={tryLoc:e[0]};1 in e&&(t.catchLoc=e[1]),2 in e&&(t.finallyLoc=e[2],t.afterLoc=e[3]),this.tryEntries.push(t)}function k(e){var t=e.completion||{};t.type="normal",delete t.arg,e.completion=t}function N(e){this.tryEntries=[{tryLoc:"root"}],e.forEach(j,this),this.reset(!0)}function S(e){if(e){var t=e[o];if(t)return t.call(e);if("function"==typeof e.next)return e;if(!isNaN(e.length)){var r=-1,a=function t(){for(;++r<e.length;)if(n.call(e,r))return t.value=e[r],t.done=!1,t;return t.value=void 0,t.done=!0,t};return a.next=a}}return{next:x}}function x(){return{value:void 0,done:!0}}return b.prototype=h,r(y,"constructor",{value:h,configurable:!0}),r(h,"constructor",{value:b,configurable:!0}),b.displayName=u(h,s,"GeneratorFunction"),e.isGeneratorFunction=function(e){var t="function"==typeof e&&e.constructor;return!!t&&(t===b||"GeneratorFunction"===(t.displayName||t.name))},e.mark=function(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,h):(e.__proto__=h,u(e,s,"GeneratorFunction")),e.prototype=Object.create(y),e},e.awrap=function(e){return{__await:e}},g(E.prototype),u(E.prototype,c,function(){return this}),e.AsyncIterator=E,e.async=function(t,n,r,a,i){void 0===i&&(i=Promise);var o=new E(l(t,n,r,a),i);return e.isGeneratorFunction(n)?o:o.next().then(function(e){return e.done?e.value:o.next()})},g(y),u(y,s,"Generator"),u(y,o,function(){return this}),u(y,"toString",function(){return"[object Generator]"}),e.keys=function(e){var t=Object(e),n=[];for(var r in t)n.push(r);return n.reverse(),function e(){for(;n.length;){var r=n.pop();if(r in t)return e.value=r,e.done=!1,e}return e.done=!0,e}},e.values=S,N.prototype={constructor:N,reset:function(e){if(this.prev=0,this.next=0,this.sent=this._sent=void 0,this.done=!1,this.delegate=null,this.method="next",this.arg=void 0,this.tryEntries.forEach(k),!e)for(var t in this)"t"===t.charAt(0)&&n.call(this,t)&&!isNaN(+t.slice(1))&&(this[t]=void 0)},stop:function(){this.done=!0;var e=this.tryEntries[0].completion;if("throw"===e.type)throw e.arg;return this.rval},dispatchException:function(e){if(this.done)throw e;var t=this;function r(n,r){return o.type="throw",o.arg=e,t.next=n,r&&(t.method="next",t.arg=void 0),!!r}for(var a=this.tryEntries.length-1;a>=0;--a){var i=this.tryEntries[a],o=i.completion;if("root"===i.tryLoc)return r("end");if(i.tryLoc<=this.prev){var c=n.call(i,"catchLoc"),s=n.call(i,"finallyLoc");if(c&&s){if(this.prev<i.catchLoc)return r(i.catchLoc,!0);if(this.prev<i.finallyLoc)return r(i.finallyLoc)}else if(c){if(this.prev<i.catchLoc)return r(i.catchLoc,!0)}else{if(!s)throw new Error("try statement without catch or finally");if(this.prev<i.finallyLoc)return r(i.finallyLoc)}}}},abrupt:function(e,t){for(var r=this.tryEntries.length-1;r>=0;--r){var a=this.tryEntries[r];if(a.tryLoc<=this.prev&&n.call(a,"finallyLoc")&&this.prev<a.finallyLoc){var i=a;break}}i&&("break"===e||"continue"===e)&&i.tryLoc<=t&&t<=i.finallyLoc&&(i=null);var o=i?i.completion:{};return o.type=e,o.arg=t,i?(this.method="next",this.next=i.finallyLoc,m):this.complete(o)},complete:function(e,t){if("throw"===e.type)throw e.arg;return"break"===e.type||"continue"===e.type?this.next=e.arg:"return"===e.type?(this.rval=this.arg=e.arg,this.method="return",this.next="end"):"normal"===e.type&&t&&(this.next=t),m},finish:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var n=this.tryEntries[t];if(n.finallyLoc===e)return this.complete(n.completion,n.afterLoc),k(n),m}},catch:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var n=this.tryEntries[t];if(n.tryLoc===e){var r=n.completion;if("throw"===r.type){var a=r.arg;k(n)}return a}}throw new Error("illegal catch attempt")},delegateYield:function(e,t,n){return this.delegate={iterator:S(e),resultName:t,nextLoc:n},"next"===this.method&&(this.arg=void 0),m}},e}var o=function(){var e=Object(r.a)(i().mark(function e(){var t;return i().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,a.a.get("https://sheet.best/api/sheets/97c28ba9-1020-447b-a425-97c74c9babff").then(function(e){return e}).catch(function(e){console.log(e)});case 2:return t=e.sent,e.abrupt("return",t);case 4:case"end":return e.stop()}},e)}));return function(){return e.apply(this,arguments)}}(),c=function(){var e=Object(r.a)(i().mark(function e(t){return i().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,a.a.patch("https://sheet.best/api/sheets/97c28ba9-1020-447b-a425-97c74c9babff/Number/".concat(t.Number),t).then(function(e){console.log(e)});case 2:case"end":return e.stop()}},e)}));return function(t){return e.apply(this,arguments)}}(),s=function(){var e=Object(r.a)(i().mark(function e(t){return i().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,a.a.post("https://sheet.best/api/sheets/97c28ba9-1020-447b-a425-97c74c9babff",t).then(function(e){console.log(e)});case 2:case"end":return e.stop()}},e)}));return function(t){return e.apply(this,arguments)}}()},41:function(e,t){},45:function(e,t,n){e.exports=n.p+"static/media/logo.21319a63.png"},56:function(e,t,n){e.exports=n(79)},63:function(e,t,n){},64:function(e,t,n){},70:function(e,t){},71:function(e,t){},79:function(e,t,n){"use strict";n.r(t);var r=n(1),a=n.n(r),i=n(42),o=n.n(i),c=(n(63),function(e){e&&e instanceof Function&&n.e(3).then(n.bind(null,86)).then(function(t){var n=t.getCLS,r=t.getFID,a=t.getFCP,i=t.getLCP,o=t.getTTFB;n(e),r(e),a(e),i(e),o(e)})}),s=n(4),u=n(13),l=n(45),d=n.n(l),m=(n(64),n(0)),f=n.n(m),b=n(19),h=n(9),v=n(38),p=n(49),_=n(27),y=a.a.memo(function(e){var t=e.user,n=e.editedUser,r=e.setEditedUser;return a.a.createElement("div",null,f.a.map(h.a,function(e){return a.a.createElement("div",null,a.a.createElement("div",null,e),a.a.createElement(_.a,{value:f.a.get(t,e),onChange:function(t){r(f.a.set(n,e,t))}}))}))}),g=a.a.memo(function(e){var t=e.searchValue,n=void 0===t?null:t,i=e.isShown,o=e.canEdit,c=e.setShowOverlay,s=e.dataFormatted,l=e.setDataFormatted,d=e.setCheckInDisabled,m=e.setCheckOutDisabled,h=e.setSearchValue,v=e.searchResult,_=e.setSearchResult,g=e.setTally,E=e.tally,w=Object(r.useState)({}),O=Object(u.a)(w,2),j=O[0],k=O[1],N=n?f.a.find(s,function(e){if((e.Number||e.surname)&&(e.Number==n||e.surname==n))return e}):null;return a.a.createElement(p.a,{isShown:i,isModal:!0,onEscape:function(){return e.setShowOverlay(!1)},onBackgroundClick:function(){return c(!1)}},a.a.createElement("div",{className:"main-content"},a.a.createElement(a.a.Fragment,null,a.a.createElement("form",{className:"Add-Point-Form",method:"get"},a.a.createElement("label",null,"".concat(n))),a.a.createElement(y,{user:N,canEdit:o,editedUser:j,setEditedUser:k}),a.a.createElement("div",{className:"Controls"},a.a.createElement("button",{onClick:function(){c(!1),o?Object(b.g)(j,N,s,l,k,g):Object(b.a)(N,s,E,l,d,m,v,_,g),h(null)}},o?"Submit":"Check In"),a.a.createElement("button",{onClick:function(){c(!1),h(null)}},"Cancel")))))}),E=n(85),w=n(84),O=n(25),j=a.a.memo(function(){var e=Object(r.useState)({rows:[],cols:[]}),t=Object(u.a)(e,2),n=t[0],i=(t[1],Object(r.useState)([])),o=Object(u.a)(i,2),c=o[0],l=o[1],m=Object(r.useState)("-1"),p=Object(u.a)(m,2),_=p[0],y=p[1],j=Object(r.useState)(!0),k=Object(u.a)(j,2),N=k[0],S=k[1],x=Object(r.useState)(!0),C=Object(u.a)(x,2),L=C[0],D=C[1],F=Object(r.useState)(!0),T=Object(u.a)(F,2),P=T[0],A=T[1],I=Object(r.useState)(!1),Y=Object(u.a)(I,2),V=Y[0],B=Y[1],G=Object(r.useState)(""),M=Object(u.a)(G,2),R=M[0],U=M[1],J=Object(r.useState)(!1),K=Object(u.a)(J,2),W=K[0],H=K[1],q=Object(r.useState)([]),z=Object(u.a)(q,2),Q=z[0],X=z[1],Z=Object(r.useState)(0),$=Object(u.a)(Z,2),ee=$[0],te=$[1],ne=Object(r.useState)(0),re=Object(u.a)(ne,2),ae=re[0],ie=re[1],oe=0;Object(r.useEffect)(function(){0===oe&&(Object(O.a)().then(function(e){var t=f.a.flatten(e.data),n=Object(b.d)(t,ee,te);l(n),te(Object(b.f)(n))}),oe=1)},[n]);var ce={searchValue:R,isShown:V,canEdit:W,setShowOverlay:function(e){B(e)},dataFormatted:c,setDataFormatted:function(e){l(e)},setCheckInDisabled:function(e){S(e)},setCheckOutDisabled:function(e){D(e)},setSearchValue:function(e){U(e)},searchResult:Q,setSearchResult:X,setTally:te,tally:ee},se=f.a.isEmpty(Q)?c.length?c.length:0:Q.length;return a.a.createElement("div",{className:"App"},V&&a.a.createElement("div",{id:"opaque"}),a.a.createElement("header",{className:"App-header"},a.a.createElement("img",{src:d.a,className:"App-logo",alt:"logo"}),a.a.createElement("div",null,"JCC Krakow Check In")),a.a.createElement("div",{className:"Grid-Header"},a.a.createElement("div",null,"This Week's Tally: ",ee),a.a.createElement("div",{className:"Buttons"},a.a.createElement("button",{disabled:N,onClick:function(){return Object(b.a)(_,c,ee,l,S,D,Q,X,te)}},"Check In"),a.a.createElement("button",{disabled:L,onClick:function(){return Object(b.b)(_,c,ee,l,S,D,Q,X,te)}},"Check Out"),a.a.createElement("button",{onClick:function(){B(!0),H(!0)}},"Add Family"),a.a.createElement("button",{disabled:P,onClick:function(){B(!0),H(!0)}},"Edit Family"),a.a.createElement("button",{onClick:function(){Object(b.c)(c)}},"Export"))),a.a.createElement("div",{className:"App-Body"},a.a.createElement("p",null,a.a.createElement("div",{className:"search-bar"},"Search by surname or UID:",a.a.createElement(E.a,{onChangeDebounced:function(e){return U(e)},onSubmit:function(){return X(Object(b.e)(R,c,ie))}}),a.a.createElement("div",{className:"submit"},a.a.createElement("button",{onClick:function(){return X(Object(b.e)(R,c,ie))}}," Submit")),a.a.createElement("div",{className:"clear"},a.a.createElement("button",{onClick:function(){return X(Object(b.e)("",c,ie))}}," Clear"))),a.a.createElement(g,ce),a.a.createElement("div",{className:"data-table"},c?a.a.createElement(v.a,{data:f.a.isEmpty(Q)?0==ae?c.slice(0,19):c.slice(10*(ae+1),10*(ae+1)+20):0==ae?Q.slice(0,19):Q.slice(10*(ae+1),10*(ae+1)+20),isSelectable:!0,onSelect:function(e){y(e.Number),function(e){A(_===e.Number),S(_===e.Number||"Yes"===e.visited_in_last_week),D(_===e.Number);var t=f.a.map(f.a.isEmpty(Q)?c:Q,function(t){return e.Number===t.Number?Object(s.a)({},t,{isSelected:!e.isSelected}):Object(s.a)({},t,{isSelected:!1})});U(e.Number),f.a.isEmpty(Q)?l(t):X(t)}(e)},emptyCellText:"--",hasLightHeader:!1},f.a.map(h.a,function(e){return a.a.createElement(v.a.Column,{field:"".concat(e)}," ",e," ")})):"",a.a.createElement(w.a,{onPageSelect:function(e){ie(e)},selectedPageIndex:ae,totalCount:se})))),a.a.createElement("a",{className:"App-link",href:"https://reactjs.org",target:"_blank",rel:"noopener noreferrer"}))}),k=n(52);o.a.createRoot(document.getElementById("root")).render(a.a.createElement(a.a.StrictMode,null,a.a.createElement(j,null))),c();Object(k.a)(function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0;switch((arguments.length>1?arguments[1]:void 0).type){case"INCREMENT":return e+1;case"DECREMENT":return e-1;default:return e}})},9:function(e,t,n){"use strict";var r,a,i;n.d(t,"a",function(){return r}),n.d(t,"b",function(){return i}),function(e){e.Number="Number",e.surname="surname",e.name="name",e.second_member="second_member",e.number_of_kids="number_of_kids",e.address="address",e.city="city",e.border_crossing="border_crossing",e.year_of_birth="year_of_birth",e.last_visit="last_visit",e.visited_in_last_week="visited_in_last_week",e.comments="comments",e.deny="deny"}(r||(r={})),function(e){e.Number="Number",e.surname="Family Surname",e.name="Name",e.second_member="Second Member",e.number_of_kids="Number of Kids",e.address="Address",e.border_crossing="Border Crossing",e.city="City",e.year_of_birth="Year of Birth",e.last_visit="Last Visit",e.visited_in_last_week="Visited in Last Week",e.comments="Comments",e.deny="Deny",e.previous_visits="Previous Visits"}(a||(a={})),function(e){e[e.Number=8]="Number",e[e.surname=9]="surname",e[e.name=10]="name",e[e.second_member=11]="second_member",e[e.number_of_kids=12]="number_of_kids",e[e.address=14]="address",e[e.city=17]="city",e[e.year_of_birth=15]="year_of_birth",e[e.border_crossing=19]="border_crossing",e[e.last_visit=20]="last_visit",e[e.visited_in_last_week=21]="visited_in_last_week",e[e.comments=22]="comments",e[e.previous_visits=23]="previous_visits",e[e.deny=24]="deny"}(i||(i={}));a.Number,a.surname,a.name,a.second_member,a.number_of_kids,a.address,a.city,a.year_of_birth,a.border_crossing,a.last_visit,a.visited_in_last_week,a.comments,a.previous_visits,a.deny}},[[56,1,2]]]);
//# sourceMappingURL=main.d8586015.chunk.js.map